#!/bin/bash
# Demo script to show the difference between ZIP and Container deployment

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘  AWS Lambda Deployment: ZIP vs Container Image                â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "â”‚ BEFORE: ZIP Package Deployment                                  â”‚"
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""
echo "  ğŸ“ SAM Template:"
echo "    Properties:"
echo "      CodeUri: ../lambda/"
echo "      Handler: chat_handler.lambda_handler"
echo "      Runtime: python3.12  â† Defined in Globals"
echo ""
echo "  ğŸ”¨ Build Command:"
echo "    sam build --use-container"
echo "    â””â”€> Creates temp container"
echo "    â””â”€> Builds dependencies inside"
echo "    â””â”€> Packages as ZIP"
echo "    â””â”€> Discards container"
echo ""
echo "  ğŸ“¦ Deployment Package:"
echo "    â”œâ”€ chat_handler.py"
echo "    â”œâ”€ anthropic/ (library)"
echo "    â”œâ”€ boto3/ (library)"
echo "    â””â”€ [other dependencies]"
echo "    Total: < 250 MB (hard limit)"
echo ""
echo "  âš ï¸  Issues:"
echo "    â€¢ Limited to 250 MB"
echo "    â€¢ Binary compatibility issues possible"
echo "    â€¢ Build container not used in production"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "â”‚ AFTER: Container Image Deployment âœ¨                            â”‚"
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""
echo "  ğŸ“ SAM Template:"
echo "    Properties:"
echo "      PackageType: Image"
echo "    Metadata:"
echo "      Dockerfile: Dockerfile"
echo "      DockerContext: ../lambda/"
echo ""
echo "  ğŸ“„ Dockerfile:"
echo "    FROM public.ecr.aws/lambda/python:3.12"
echo "    COPY requirements.txt ."
echo "    RUN pip install -r requirements.txt"
echo "    COPY chat_handler.py ."
echo "    CMD [\"chat_handler.lambda_handler\"]"
echo ""
echo "  ğŸ”¨ Build Command:"
echo "    sam build"
echo "    â””â”€> Builds Docker image"
echo "    â””â”€> Pushes to Amazon ECR"
echo "    â””â”€> Lambda uses this exact image"
echo ""
echo "  ğŸ³ Container Image:"
echo "    AWS Lambda Base (Python 3.12)"
echo "    â”œâ”€ System packages"
echo "    â”œâ”€ Python runtime"
echo "    â”œâ”€ anthropic/ (library)"
echo "    â”œâ”€ boto3/ (library)"
echo "    â””â”€ chat_handler.py"
echo "    Total: < 10 GB (generous limit)"
echo ""
echo "  âœ… Benefits:"
echo "    â€¢ 10 GB limit (40x larger!)"
echo "    â€¢ Perfect binary compatibility"
echo "    â€¢ Same container dev â†’ prod"
echo "    â€¢ Easier local testing"
echo "    â€¢ Layer caching speeds up builds"
echo ""

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘  For Users: No Change Required!                               â•‘"
echo "â•‘  Same command: ./deploy-safe.sh                               â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
